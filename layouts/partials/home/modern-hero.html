{{/* Use site section for the current language */}}
{{ $lang_news_path := printf "/%s/news" .Site.Language.Lang }}
{{ $sec := .Site.GetPage $lang_news_path }}
{{ $all := cond (ne $sec nil) ($sec.RegularPages | default $sec.Pages) (slice) }}
{{ if eq (len $all) 0 }}
  {{/* Fallback: derive by type + language */}}
  {{ $all = where (where .Site.Pages "Type" "news") "Lang" .Site.Language.Lang }}
{{ end }}
{{ $local_list  := union (where $all ".Params.categories" "intersect" (slice "local")) (where $all ".Params.categories" "eq" "local") }}
{{ $national_list := union (where $all ".Params.categories" "intersect" (slice "national")) (where $all ".Params.categories" "eq" "national") }}
{{ $service_list  := union (where $all ".Params.categories" "intersect" (slice "servicii-publice")) (where $all ".Params.categories" "eq" "servicii-publice") }}

{{/* 1. Most recent featured local article (if any) */}}
{{ $featured_local := where $local_list ".Params.featured" true }}
{{ $featured_story := first 1 $featured_local }}

{{/* 2. If no featured, prioritize local news with format 'stire' */}}
{{ $local_news_list := union (where $local_list ".Params.formats" "intersect" (slice "stire")) (where $local_list ".Params.formats" "eq" "stire") }}
{{ $local_news := first 1 $local_news_list }}
{{ $local_story := $featured_story | default $local_news | default (first 1 $local_list) }}

{{/* 3. Latest national and service stories */}}
{{ $national_story := first 1 $national_list }}
{{ $service_story := first 1 $service_list }}

<section class="modern-hero">
  <div class="hero-grid">
    {{ with $local_story }}
      <div class="hero-main">
        {{ range . }}
          {{ partial "home/category-card.html" (dict "page" . "card_class" "card-hero-main") }}
        {{ end }}
      </div>
    {{ end }}
    <div class="hero-sub">
      {{ with $national_story }}
        {{ range . }}
          {{ partial "home/category-card.html" (dict "page" . "card_class" "card-hero-sub") }}
        {{ end }}
      {{ end }}
      {{ with $service_story }}
        {{ range . }}
          {{ partial "home/category-card.html" (dict "page" . "card_class" "card-hero-sub card-service-alert") }}
        {{ end }}
      {{ end }}
    </div>
  </div>
</section>
