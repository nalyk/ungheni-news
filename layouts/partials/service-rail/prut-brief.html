{{/* Prut Brief Newsletter Signup Service Rail Component */}}
<section class="service-rail newsletter card">
  <h3>{{ i18n "prut_brief_title" | default "Prut Brief - Newsletter local" }}</h3>
  
  <div class="newsletter-content">
    <div class="newsletter-description">
      <p>{{ i18n "prut_brief_description" | default "Cele mai importante știri locale, zilnic la 18:00" }}</p>
    </div>
    
    <div class="newsletter-stats">
      <div class="subscriber-count">
        <span class="count-number">2.847</span>
        <span class="count-label">{{ i18n "subscribers" | default "abonați" }}</span>
      </div>
    </div>
    
    <form class="newsletter-form" action="#" method="post" id="newsletter-signup">
      <div class="form-group">
        <label for="newsletter-email" class="sr-only">{{ i18n "email_address" | default "Adresa de email" }}</label>
        <input 
          type="email" 
          id="newsletter-email" 
          name="email" 
          placeholder="{{ i18n "email_placeholder" | default "adresa@email.com" }}"
          required
          class="email-input"
          aria-describedby="email-error"
        />
        <div id="email-error" class="error-message" role="alert"></div>
      </div>
      
      <button type="submit" class="submit-button">
        {{ i18n "subscribe_free" | default "Abonează-te gratuit" }}
      </button>
      
      <div class="form-status" role="status" aria-live="polite"></div>
    </form>
    
    <div class="newsletter-preview">
      <a href="#" class="preview-link">
        {{ i18n "sample_newsletter" | default "Vezi un exemplu de newsletter" }}
        <span class="external-indicator">↗</span>
      </a>
    </div>
    
    <div class="privacy-note">
      <small>{{ i18n "privacy_note" | default "Nu spam, dezabonare oricând. Datele sunt protejate conform GDPR." }}</small>
    </div>
  </div>
</section>

<script>
(function() {
  const form = document.getElementById('newsletter-signup');
  const emailInput = document.getElementById('newsletter-email');
  const errorDiv = document.getElementById('email-error');
  const statusDiv = document.querySelector('.form-status');
  
  if (!form) return;
  
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Clear previous messages
    clearMessages();
    
    const email = emailInput.value.trim();
    
    // Client-side validation
    if (!validateEmail(email)) {
      showError('{{ i18n "invalid_email" | default "Vă rugăm să introduceți o adresă de email validă" }}');
      return;
    }
    
    // Show loading state
    showStatus('{{ i18n "subscribing" | default "Se înregistrează..." }}');
    const submitButton = form.querySelector('.submit-button');
    submitButton.disabled = true;
    
    // Simulate API call (replace with actual implementation)
    setTimeout(() => {
      showStatus('{{ i18n "subscription_success" | default "Mulțumim! Veți primi primul newsletter astăzi la 18:00." }}', 'success');
      emailInput.value = '';
      submitButton.disabled = false;
      
      // Update subscriber count (demo)
      const countElement = document.querySelector('.count-number');
      if (countElement) {
        const currentCount = parseInt(countElement.textContent.replace(',', ''));
        countElement.textContent = (currentCount + 1).toLocaleString();
      }
    }, 1500);
  });
  
  emailInput.addEventListener('input', function() {
    clearMessages();
  });
  
  function validateEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }
  
  function showError(message) {
    errorDiv.textContent = message;
    errorDiv.style.display = 'block';
    emailInput.setAttribute('aria-invalid', 'true');
  }
  
  function showStatus(message, type = 'info') {
    statusDiv.textContent = message;
    statusDiv.className = 'form-status ' + type;
    statusDiv.style.display = 'block';
  }
  
  function clearMessages() {
    errorDiv.style.display = 'none';
    errorDiv.textContent = '';
    statusDiv.style.display = 'none';
    statusDiv.textContent = '';
    emailInput.removeAttribute('aria-invalid');
  }
})();
</script>